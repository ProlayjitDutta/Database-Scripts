CREATE OR REPLACE FUNCTION func_tracker_save_orders_dye(
    IN v_dye_order_no VARCHAR(500),
    IN v_dye_requisition_id int,
    IN v_dye_custom_requisition_id int,
    IN v_custom_requisition char(1),
    IN v_approve char(1),
    OUT output_msg text,
    OUT id integer)
  RETURNS record AS
$BODY$
BEGIN   
					
		IF v_approve='Y' THEN
			INSERT INTO tracker_orders_dye (
			  dye_order_no,
			  dye_requisition_id,
			  dye_custom_requisition_id
			)
			VALUES(			
			$1,
			$2,
			$3
			) RETURNING order_id into id;
		END IF;
			
		IF v_approve='Y' THEN
			IF v_custom_requisition='N' THEN
				UPDATE TRACKER_REQUISITION_DYE SET approved='Y' WHERE dye_requisition_id=v_dye_requisition_id;
				output_msg:='Successfully Updated';	
			ELSIF v_custom_requisition='Y' THEN
				UPDATE TRACKER_CUSTOM_REQUISITION_DYE SET approved='Y' WHERE dye_custom_requisition_id=v_dye_custom_requisition_id;
				output_msg:='Successfully Updated';	
			END IF;
		ELSIF v_approve='N' THEN
			IF v_custom_requisition='N' THEN
				UPDATE TRACKER_REQUISITION_DYE SET approved='N' WHERE dye_requisition_id=v_dye_requisition_id;
				output_msg:='Successfully Updated';	
			ELSIF v_custom_requisition='Y' THEN
				UPDATE TRACKER_CUSTOM_REQUISITION_DYE SET approved='N' WHERE dye_custom_requisition_id=v_dye_custom_requisition_id;
				output_msg:='Successfully Updated';	
			END IF;
		END IF;
		
END
$BODY$
  LANGUAGE plpgsql;
