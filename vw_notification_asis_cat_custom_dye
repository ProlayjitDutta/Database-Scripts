-- View: vw_notification_asis_cat_custom_dye

-- DROP VIEW vw_notification_asis_cat_custom_dye;

CREATE OR REPLACE VIEW vw_notification_asis_cat_custom_dye AS 
 SELECT v_asis_dye.category_planning_id,
    v_asis_dye.product_codes,
    v_asis_dye.production_type,
    v_asis_dye.sc_planning_main_item_id,
    v_asis_dye.plan_item_code,
    v_asis_dye.transaction_id,
    v_asis_dye.total_quantity,
    v_asis_dye.raw_material_min_date,
    v_asis_dye.raw_material_max_date,
    v_asis_dye.style_item_code,
    v_asis_dye.category_name,
    v_asis_dye.style_item_name,
    v_asis_dye.style_code,
    v_asis_dye.color_code,
    v_asis_dye.color,
    v_asis_dye.style_item_quantity,
    v_asis_dye.style_item_std_unit,
    v_asis_dye.style_total_cost,
    v_asis_dye.style_ccode_id,
    v_asis_dye.item_code,
    v_asis_dye.item_name,
    v_asis_dye.item_quantity,
    v_asis_dye.item_std_unit,
    v_asis_dye.dye_code,
    v_asis_dye.dye_colour_name,
    v_asis_dye.generic_color_name,
    v_asis_dye.dye_process_name,
    v_asis_dye.num_colours,
    v_asis_dye.color_hex_codes,
    v_asis_dye.length_metre,
    v_asis_dye.width_inches,
    v_asis_dye.pcs,
    v_asis_dye.total_measurement,
    v_asis_dye.total_cost,
    v_asis_dye.sc_asis_plan_dye_item_id,
    v_asis_dye.dye_trans_id,
    v_asis_dye.asis_dye_total_length_metre,
    v_asis_dye.asis_dye_total_width_inch,
    v_asis_dye.asis_dye_total_pcs,
    v_asis_dye.asis_dye_total_measurement,
    v_asis_dye.dye_issue_min_date,
    v_asis_dye.dye_issue_max_date,
    v_asis_dye.dye_delivery_min_date,
    v_asis_dye.dye_delivery_max_date,    
    v_asis_dye.fabric_code,
    v_asis_dye.fabric_name,
    v_asis_dye.fabric_type,
    v_asis_dye.sent_for_approval,
    v_asis_dye.item_approved,
    v_asis_dye.custom,
    v_asis_dye.dept_changed AS asis_dept_changed,
    sub_custom.dept_changed AS cat_custom_dept_changed,
    sub_custom.cat_custom_plan_dye_item_id,
    sub_custom.cat_custom_transaction_id,    
    sub_custom.cat_custom_dye_total_length_metre,
    sub_custom.cat_custom_dye_total_width_inch,
    sub_custom.cat_custom_dye_total_pcs,
    sub_custom.cat_custom_dye_total_measurement,
    sub_custom.cat_custom_dye_issue_min_date,
    sub_custom.cat_custom_dye_issue_max_date,
    sub_custom.cat_custom_dye_delivery_min_date,
    sub_custom.cat_custom_dye_delivery_max_date
   FROM vw_sc_dept_item_disp_asis_dye v_asis_dye
     LEFT JOIN ( SELECT 
	    cat_custom_dye.sc_custom_plan_dye_item_id AS cat_custom_plan_dye_item_id,
            cat_custom_dye.transaction_id AS cat_custom_transaction_id,
            cat_custom_dye.dept_changed,
            cat_custom_dye.dye_total_length_metre AS cat_custom_dye_total_length_metre,
            cat_custom_dye.dye_total_width_inches AS cat_custom_dye_total_width_inch,
            cat_custom_dye.dye_total_pcs AS cat_custom_dye_total_pcs,
            cat_custom_dye.dye_total_measurement AS cat_custom_dye_total_measurement,
            cat_custom_dye.dye_issue_max_date AS cat_custom_dye_issue_min_date,
            cat_custom_dye.dye_issue_max_date AS cat_custom_dye_issue_max_date,
            cat_custom_dye.dye_delivery_min_date AS cat_custom_dye_delivery_min_date,
            cat_custom_dye.dye_delivery_max_date AS cat_custom_dye_delivery_max_date
           FROM vw_cat_custom_dye cat_custom_dye) sub_custom ON sub_custom.cat_custom_transaction_id::text = v_asis_dye.transaction_id::text;

ALTER TABLE vw_notification_asis_cat_custom_dye
  OWNER TO postgres;
