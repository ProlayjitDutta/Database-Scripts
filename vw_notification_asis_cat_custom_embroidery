-- View: vw_notification_asis_cat_custom_embroidery

-- DROP VIEW vw_notification_asis_cat_custom_embroidery;

CREATE OR REPLACE VIEW vw_notification_asis_cat_custom_embroidery AS 
 SELECT v_asis_embrd.category_planning_id,
    v_asis_embrd.product_codes,
    v_asis_embrd.production_type,
    v_asis_embrd.sc_planning_main_item_id,
    v_asis_embrd.plan_item_code,
    v_asis_embrd.transaction_id,
    v_asis_embrd.total_quantity,
    v_asis_embrd.raw_material_min_date,
    v_asis_embrd.raw_material_max_date,
    v_asis_embrd.style_item_code,
    v_asis_embrd.category_name,
    v_asis_embrd.style_item_name,
    v_asis_embrd.style_code,
    v_asis_embrd.color_code,
    v_asis_embrd.color,
    v_asis_embrd.style_item_quantity,
    v_asis_embrd.style_item_std_unit,
    v_asis_embrd.style_total_cost,
    v_asis_embrd.style_ccode_id,
    v_asis_embrd.item_code,
    v_asis_embrd.item_name,
    v_asis_embrd.item_quantity,
    v_asis_embrd.item_std_unit,
    v_asis_embrd.embroidery_code,
    v_asis_embrd.embroidery_description,
    v_asis_embrd.embroidery_photo_path,
    v_asis_embrd.vendor_code,
    v_asis_embrd.embrd_std_unit,
    v_asis_embrd.fabric_code,
    v_asis_embrd.fabric_base_colour,
    v_asis_embrd.fabric_metre,
    v_asis_embrd.fabric_inches,
    v_asis_embrd.fabric_pcs,
    v_asis_embrd.material_reference,
    v_asis_embrd.metre,
    v_asis_embrd.pcs,
    v_asis_embrd.embroidery_set,
    v_asis_embrd.line,
    v_asis_embrd.length_inch1,
    v_asis_embrd.width_inch2,
    v_asis_embrd.height_inch3,
    v_asis_embrd.total_measurement,
    v_asis_embrd.total_cost,
    v_asis_embrd.sc_asis_plan_embrd_item_id,
    v_asis_embrd.embrd_trans_id,
    v_asis_embrd.asis_embroidery_total_metre,
    v_asis_embrd.asis_embroidery_total_pcs,
    v_asis_embrd.asis_embroidery_total_set,
    v_asis_embrd.asis_embroidery_total_line,
    v_asis_embrd.asis_embroidery_total_length_inch1,
    v_asis_embrd.asis_embroidery_total_width_inch2,
    v_asis_embrd.asis_embroidery_total_height_inch3,
    v_asis_embrd.asis_embroidery_total_measurement,
    v_asis_embrd.embroidery_issue_min_date,
    v_asis_embrd.embroidery_issue_max_date,
    v_asis_embrd.embroidery_delivery_min_date,
    v_asis_embrd.embroidery_delivery_max_date,    
    v_asis_embrd.fabric_name,
    v_asis_embrd.custom,
    v_asis_embrd.sent_for_approval,
    v_asis_embrd.item_approved,
    v_asis_embrd.dept_changed AS asis_dept_changed,
    sub_custom.dept_changed AS cat_custom_dept_changed,
    sub_custom.cat_custom_plan_embrd_item_id,
    sub_custom.cat_custom_transaction_id,    
    sub_custom.cat_custom_embrd_total_metre,
    sub_custom.cat_custom_embrd_total_pcs,
    sub_custom.cat_custom_embrd_total_set,
    sub_custom.cat_custom_embrd_total_line,
    sub_custom.cat_custom_embrd_total_length_inch1,
    sub_custom.cat_custom_embrd_total_width_inch2,
    sub_custom.cat_custom_embrd_total_height_inch3,
    sub_custom.cat_custom_embrd_total_measurement,
    sub_custom.cat_custom_embrd_issue_min_date,
    sub_custom.cat_custom_embrd_issue_max_date,
    sub_custom.cat_custom_embrd_delivery_min_date,
    sub_custom.cat_custom_embrd_delivery_max_date
   FROM vw_sc_dept_item_disp_asis_embroidery v_asis_embrd
     LEFT JOIN ( SELECT 
		cat_custom_embrd.sc_custom_plan_embd_item_id AS cat_custom_plan_embrd_item_id,
		cat_custom_embrd.transaction_id AS cat_custom_transaction_id,
            cat_custom_embrd.dept_changed,
            cat_custom_embrd.embroidery_total_metre AS cat_custom_embrd_total_metre,
            cat_custom_embrd.embroidery_total_pcs AS cat_custom_embrd_total_pcs,
            cat_custom_embrd.embroidery_total_set AS cat_custom_embrd_total_set,
            cat_custom_embrd.embroidery_total_line AS cat_custom_embrd_total_line,
            cat_custom_embrd.embroidery_total_length_inch1 AS cat_custom_embrd_total_length_inch1,
            cat_custom_embrd.embroidery_total_width_inch2 AS cat_custom_embrd_total_width_inch2,
            cat_custom_embrd.embroidery_total_height_inch3 AS cat_custom_embrd_total_height_inch3,
            cat_custom_embrd.embroidery_total_measurement AS cat_custom_embrd_total_measurement,
            cat_custom_embrd.embroidery_issue_min_date AS cat_custom_embrd_issue_min_date,
            cat_custom_embrd.embroidery_issue_max_date AS cat_custom_embrd_issue_max_date,
            cat_custom_embrd.embroidery_delivery_min_date AS cat_custom_embrd_delivery_min_date,
            cat_custom_embrd.embroidery_delivery_max_date AS cat_custom_embrd_delivery_max_date
           FROM vw_cat_custom_embroidery cat_custom_embrd) sub_custom ON sub_custom.cat_custom_transaction_id::text = v_asis_embrd.transaction_id::text;

ALTER TABLE vw_notification_asis_cat_custom_embroidery
  OWNER TO postgres;
